#set-window-option -g mode-keys vi
bind-key -T copy-mode-vi v send-keys -X begin-selection
bind -T copy-mode-vi y send-keys -X copy-pipe-and-cancel 'xclip -in -selection clipboard'
bind -T copy-mode-vi Enter send -X copy-pipe-and-cancel 'xclip -in -selection clipboard'

# vim-like pane switching
bind k select-pane -U
bind j select-pane -D
bind h select-pane -L
bind l select-pane -R

# repeatable window navigation (Ctrl-a n n n to advance multiple windows)
set-option -g repeat-time 800
bind-key -r n next-window
bind-key -r p previous-window

# show current working directory (useful when running TUI apps)
bind-key P display-message "#{pane_current_path}"

# ============================================
# Idle-Fade Window Colors
# ============================================
# Color windows based on time since last activity (output in unfocused windows)

# Enable activity/bell monitoring (activity-action other = only alert for non-current windows)
set -g monitor-activity on
set -g activity-action other
set -g monitor-bell on

# Track activity only in non-current windows via alert hook
set-hook -g alert-activity 'run-shell "tmux set-option -w -t \"#{window_id}\" @last_activity $(date +%s)"'

# Status bar refresh rate (2s - balance between responsiveness and CPU)
set -g status-interval 2

# Window status format - idle windows call script for color calculation
# Args: window_index, window_name, window_flags, bell_flag, last_activity
set -g window-status-format '#(~/.config/tmux/idle-color.sh "#{window_index}" "#{window_name}" "#{window_flags}" "#{window_bell_flag}" "#{@last_activity}")'
set -g window-status-current-format '#[fg=#ebdbb2,bg=#504945,bold] #I:#W #[default]'

# ============================================
# Custom Gruvbox-style Theme
# ============================================
set -g status-style 'bg=#282828,fg=#ebdbb2'
set -g window-status-style 'bg=default'
set -g window-status-activity-style 'bg=default'
set -g status-left '#[fg=#282828,bg=#83a598,bold] #S #[default] '
set -g status-right '#[fg=#ebdbb2] %H:%M #[fg=#282828,bg=#83a598] #H '
set -g status-left-length 30
set -g status-right-length 50

# Pane borders
set -g pane-border-style 'fg=#504945'
set -g pane-active-border-style 'fg=#83a598'

# Message styling
set -g message-style 'bg=#282828,fg=#ebdbb2'

